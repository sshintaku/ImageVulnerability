package main

import (
	"fmt"

	"github.com/sshintaku/prisma_session"
)

func main() {
	// Create a generic session for running API calls to Prisma Cloud
	session := prisma_session.Session{ApiUrl: "https://api2.prismacloud.io/"}
	session.CreateSession()

	// Gathering Image Date based on a specific CVE vulnerability found in a given image
	imageInfoArray := session.GetImageCVEInfo("CVE-2022-22963")

	// Gathering all image data in the environment
	imageData := session.GetDeployedImages()

	// Generating the HEADERS for the CSV output
	fmt.Println("Image,Container,Host,Tas Org Name, Tas Application Name")

	// Cycling through all imageInfoArray to
	for _, item := range imageInfoArray {
		item.GetImageTags(imageData)
		report := item.Image + "," + item.Container + "," + item.Host + "," + item.TasOrgName + "," + item.TasApplicationName
		fmt.Println(report)
	}
}

